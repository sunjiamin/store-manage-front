webpackJsonp([12],{A6ef:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("Dd8w"),s=n.n(o),a=n("mvHQ"),r=n.n(a),i={name:"menu-manage",data:function(){return{loading:!0,expandAll:!1,modalType:0,menuModalVisible:!1,selectList:[],selectCount:0,showParent:!1,isButtonAdd:!1,isMenuAdd:!1,isMenu:!1,editStatus:!0,addStatus:!0,modalTitle:"",menuForm:{id:"",parentId:"",buttonType:"",type:0,sortOrder:null,level:null,status:0},menuFormAdd:{},menuFormValidate:{title:[{required:!0,message:"名称不能为空",trigger:"blur"}],name:[{required:!0,message:"英文名不能为空",trigger:"blur"}],icon:[{required:!0,message:"图标不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空",trigger:"blur"}],component:[{required:!0,message:"前端组件不能为空",trigger:"blur"}]},submitLoading:!1,data:[]}},methods:{init:function(){this.getAllList()},handleDropdown:function(t){"expandTwo"===t?(this.expandAll=!1,this.getAllList()):"expandAll"===t?(this.expandAll=!0,this.getAllList()):"refresh"===t&&this.getAllList()},getAllList:function(){var t=this;this.loading=!0,this.getRequest("/permission/getAllList").then(function(e){t.loading=!1,!0===e.success&&(t.expandAll||e.result.forEach(function(t){t.children&&t.children.length>0&&t.children.forEach(function(t){2===t.level&&(t.expand=!1)})}),t.data=e.result)})},selectTree:function(t){if(t.length>0){for(var e in 1===Number(t[0].level)||2===Number(t[0].level)?this.isMenu=!0:this.isMenu=!1,0===Number(t[0].status)?this.editStatus=!0:this.editStatus=!1,t[0])null===t[0][e]&&(t[0][e]="");var n=r()(t[0]),o=JSON.parse(n);""===o.access&&(o.access=null),this.menuForm=o}},cancelAdd:function(){this.menuModalVisible=!1},handleReset:function(){this.$refs.menuForm.resetFields()},changeEditSwitch:function(t){this.menuForm.status=t?0:1},submitEdit:function(){var t=this;this.$refs.menuForm.validate(function(e){if(e){if(!t.menuForm.id)return void t.$Message.warning("请先点击选择要修改的菜单节点");t.submitLoading=!0,null===t.menuForm.sortOrder&&(t.menuForm.sortOrder=""),null===t.menuForm.buttonType&&(t.menuForm.buttonType=""),1==t.menuForm.type&&(t.menuForm.name="",t.menuForm.icon="",t.menuForm.component=""),t.postRequest("/permission/edit",t.menuForm).then(function(e){t.submitLoading=!1,!0===e.success&&(t.$Message.success("编辑成功"),t.init(),t.menuModalVisible=!1)})}})},changeAddSwitch:function(t){this.menuFormAdd.status=t?0:1},submitAdd:function(){var t=this;this.$refs.menuFormAdd.validate(function(e){e&&(t.submitLoading=!0,null===t.menuFormAdd.sortOrder&&(t.menuFormAdd.sortOrder=""),null===t.menuFormAdd.buttonType&&(t.menuFormAdd.buttonType=""),1==t.menuFormAdd.type&&(t.menuForm.name="",t.menuForm.icon="",t.menuForm.component=""),t.postRequest("/permission/add",t.menuFormAdd).then(function(e){t.submitLoading=!1,!0===e.success&&(t.$Message.success("添加成功"),t.init(),t.menuModalVisible=!1)}))})},addMenu:function(){if(""!=this.menuForm.id&&null!=this.menuForm.id){this.modalTitle="添加菜单权限",this.showParent=!0;var t=0;1===this.menuForm.level?(t=0,this.isMenuAdd=!0,this.isButtonAdd=!1):2===this.menuForm.level?(t=1,this.isMenuAdd=!1,this.isButtonAdd=!0):(t=0,this.isMenuAdd=!1,this.isButtonAdd=!1),this.menuFormAdd={type:t,parentId:this.menuForm.id,level:Number(this.menuForm.level)+1,sortOrder:1,buttonType:"",status:0},this.menuModalVisible=!0}else this.$Message.warning("请先点击选择一个菜单权限节点")},addRootMenu:function(){this.modalTitle="添加一级菜单",this.isMenuAdd=!0,this.isButtonAdd=!1,this.showParent=!1,this.menuFormAdd={type:0,level:1,sortOrder:1,status:0},this.menuModalVisible=!0},changeSelect:function(t){this.selectCount=t.length,this.selectList=t},delAll:function(){var t=this;this.selectCount<=0?this.$Message.warning("您还未勾选要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var e="";t.selectList.forEach(function(t){e+=t.id+","}),e=e.substring(0,e.length-1),t.deleteRequest("/permission/delByIds",{ids:e}).then(function(e){!0===e.success&&(t.$Message.success("删除成功"),t.init())})}})}},mounted:function(){this.init()}},l=s()({},i),u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search"},[n("Card",[n("Row",{staticClass:"operation"},[n("Button",{attrs:{type:"primary",icon:"plus-round"},on:{click:t.addMenu}},[t._v("添加子节点")]),t._v(" "),n("Button",{attrs:{type:"ghost",icon:"plus-round"},on:{click:t.addRootMenu}},[t._v("添加一级菜单")]),t._v(" "),n("Button",{attrs:{type:"ghost",icon:"trash-a"},on:{click:t.delAll}},[t._v("批量删除")]),t._v(" "),n("Dropdown",{on:{"on-click":t.handleDropdown}},[n("Button",{attrs:{type:"ghost"}},[t._v("\n            更多操作\n            "),n("Icon",{attrs:{type:"arrow-down-b"}})],1),t._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{attrs:{name:"refresh"}},[t._v("刷新")]),t._v(" "),n("DropdownItem",{attrs:{name:"expandTwo"}},[t._v("仅展开两级")]),t._v(" "),n("DropdownItem",{attrs:{name:"expandAll"}},[t._v("展开所有")])],1)],1)],1),t._v(" "),n("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"start"}},[n("Col",{attrs:{span:"6"}},[n("Tree",{attrs:{data:t.data,"show-checkbox":""},on:{"on-check-change":t.changeSelect,"on-select-change":t.selectTree}}),t._v(" "),t.loading?n("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),t._v(" "),n("Col",{attrs:{span:"9"}},[n("Form",{ref:"menuForm",attrs:{model:t.menuForm,"label-width":85,rules:t.menuFormValidate}},[n("FormItem",{attrs:{label:"类型",prop:"type"}},[n("RadioGroup",{model:{value:t.menuForm.type,callback:function(e){t.$set(t.menuForm,"type",e)},expression:"menuForm.type"}},[n("Radio",{attrs:{label:0}},[n("Icon",{attrs:{type:"ios-list-outline"}}),t._v(" "),n("span",[t._v("页面菜单")])],1),t._v(" "),n("Radio",{attrs:{label:1,disabled:t.isMenu}},[n("Icon",{attrs:{type:"log-in"}}),t._v(" "),n("span",[t._v("操作按钮")])],1)],1)],1),t._v(" "),n("FormItem",{attrs:{label:"名称",prop:"title"}},[n("Input",{model:{value:t.menuForm.title,callback:function(e){t.$set(t.menuForm,"title",e)},expression:"menuForm.title"}})],1),t._v(" "),n("FormItem",{attrs:{label:"路径",prop:"path"}},[n("Input",{model:{value:t.menuForm.path,callback:function(e){t.$set(t.menuForm,"path",e)},expression:"menuForm.path"}})],1),t._v(" "),1===t.menuForm.type?n("FormItem",{attrs:{label:"按钮权限类型",prop:"buttonType"}},[n("Select",{attrs:{placeholder:"请选择"},model:{value:t.menuForm.buttonType,callback:function(e){t.$set(t.menuForm,"buttonType",e)},expression:"menuForm.buttonType"}},[n("Option",{attrs:{value:"add"}},[t._v("添加操作")]),t._v(" "),n("Option",{attrs:{value:"edit"}},[t._v("编辑操作")]),t._v(" "),n("Option",{attrs:{value:"delete"}},[t._v("删除操作")]),t._v(" "),n("Option",{attrs:{value:"clearAll"}},[t._v("清空全部")]),t._v(" "),n("Option",{attrs:{value:"enable"}},[t._v("启用操作")]),t._v(" "),n("Option",{attrs:{value:"disable"}},[t._v("禁用操作")]),t._v(" "),n("Option",{attrs:{value:"search"}},[t._v("搜索操作")]),t._v(" "),n("Option",{attrs:{value:"output"}},[t._v("导出操作")]),t._v(" "),n("Option",{attrs:{value:"editPerm"}},[t._v("分配权限")]),t._v(" "),n("Option",{attrs:{value:"setDefault"}},[t._v("设为默认")])],1)],1):t._e(),t._v(" "),0===t.menuForm.type?n("div",[n("FormItem",{attrs:{label:"英文名",prop:"name"}},[n("Input",{model:{value:t.menuForm.name,callback:function(e){t.$set(t.menuForm,"name",e)},expression:"menuForm.name"}})],1),t._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"图标",prop:"icon"}},[n("Input",{model:{value:t.menuForm.icon,callback:function(e){t.$set(t.menuForm,"icon",e)},expression:"menuForm.icon"}}),t._v(" "),n("span",[t._v("\n                  图标请参考 "),n("a",{attrs:{target:"_blank",href:"http://ionicons.com/"}},[n("Icon",{attrs:{type:"ionic"}}),t._v(" ionicons")],1)])],1),t._v(" "),n("FormItem",{attrs:{label:"前端组件",prop:"component"}},[n("Input",{model:{value:t.menuForm.component,callback:function(e){t.$set(t.menuForm,"component",e)},expression:"menuForm.component"}})],1)],1):t._e(),t._v(" "),n("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[n("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.menuForm.sortOrder,callback:function(e){t.$set(t.menuForm,"sortOrder",e)},expression:"menuForm.sortOrder"}}),t._v(" "),n("span",{staticStyle:{"margin-left":"5px"}},[t._v("值越小越靠前，支持小数")])],1),t._v(" "),n("FormItem",{attrs:{label:"是否启用",prop:"status"}},[n("i-switch",{attrs:{size:"large"},on:{"on-change":t.changeEditSwitch},model:{value:t.editStatus,callback:function(e){t.editStatus=e},expression:"editStatus"}},[n("span",{attrs:{slot:"open"},slot:"open"},[t._v("启用")]),t._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[t._v("禁用")])])],1),t._v(" "),n("Form-item",[n("Button",{attrs:{loading:t.submitLoading,type:"primary",icon:"compose"},on:{click:t.submitEdit}},[t._v("修改")]),t._v(" "),n("Button",{attrs:{type:"ghost"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1)],1),t._v(" "),n("Modal",{attrs:{title:t.modalTitle,"mask-closable":!1,width:500},model:{value:t.menuModalVisible,callback:function(e){t.menuModalVisible=e},expression:"menuModalVisible"}},[n("Form",{ref:"menuFormAdd",attrs:{model:t.menuFormAdd,"label-width":85,rules:t.menuFormValidate}},[t.showParent?n("div",[n("FormItem",{attrs:{label:"上级节点："}},[t._v("\n            "+t._s(t.menuForm.title)+"\n          ")])],1):t._e(),t._v(" "),n("FormItem",{attrs:{label:"类型",prop:"type"}},[n("RadioGroup",{model:{value:t.menuFormAdd.type,callback:function(e){t.$set(t.menuFormAdd,"type",e)},expression:"menuFormAdd.type"}},[n("Radio",{attrs:{label:0,disabled:t.isButtonAdd}},[n("Icon",{attrs:{type:"ios-list-outline"}}),t._v(" "),n("span",[t._v("页面菜单")])],1),t._v(" "),n("Radio",{attrs:{label:1,disabled:t.isMenuAdd}},[n("Icon",{attrs:{type:"log-in"}}),t._v(" "),n("span",[t._v("操作按钮")])],1)],1)],1),t._v(" "),n("FormItem",{attrs:{label:"名称",prop:"title"}},[n("Input",{model:{value:t.menuFormAdd.title,callback:function(e){t.$set(t.menuFormAdd,"title",e)},expression:"menuFormAdd.title"}})],1),t._v(" "),n("FormItem",{attrs:{label:"路径",prop:"path"}},[n("Input",{model:{value:t.menuFormAdd.path,callback:function(e){t.$set(t.menuFormAdd,"path",e)},expression:"menuFormAdd.path"}})],1),t._v(" "),1===t.menuFormAdd.type?n("FormItem",{attrs:{label:"按钮权限类型",prop:"buttonType"}},[n("Select",{attrs:{placeholder:"请选择"},model:{value:t.menuFormAdd.buttonType,callback:function(e){t.$set(t.menuFormAdd,"buttonType",e)},expression:"menuFormAdd.buttonType"}},[n("Option",{attrs:{value:"add"}},[t._v("添加操作")]),t._v(" "),n("Option",{attrs:{value:"edit"}},[t._v("编辑操作")]),t._v(" "),n("Option",{attrs:{value:"delete"}},[t._v("删除操作")]),t._v(" "),n("Option",{attrs:{value:"clearAll"}},[t._v("清空全部")]),t._v(" "),n("Option",{attrs:{value:"enable"}},[t._v("启用操作")]),t._v(" "),n("Option",{attrs:{value:"disable"}},[t._v("禁用操作")]),t._v(" "),n("Option",{attrs:{value:"search"}},[t._v("搜索操作")]),t._v(" "),n("Option",{attrs:{value:"output"}},[t._v("导出操作")]),t._v(" "),n("Option",{attrs:{value:"editPerm"}},[t._v("分配权限")]),t._v(" "),n("Option",{attrs:{value:"setDefault"}},[t._v("设为默认")])],1)],1):t._e(),t._v(" "),0===t.menuFormAdd.type?n("div",[n("FormItem",{attrs:{label:"英文名",prop:"name"}},[n("Input",{model:{value:t.menuFormAdd.name,callback:function(e){t.$set(t.menuFormAdd,"name",e)},expression:"menuFormAdd.name"}})],1),t._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"图标",prop:"icon"}},[n("Input",{model:{value:t.menuFormAdd.icon,callback:function(e){t.$set(t.menuFormAdd,"icon",e)},expression:"menuFormAdd.icon"}}),t._v(" "),n("span",[t._v("\n              图标请参考 "),n("a",{attrs:{target:"_blank",href:"http://ionicons.com/"}},[n("Icon",{attrs:{type:"ionic"}}),t._v(" ionicons")],1)])],1),t._v(" "),n("FormItem",{attrs:{label:"前端组件",prop:"component"}},[n("Input",{model:{value:t.menuFormAdd.component,callback:function(e){t.$set(t.menuFormAdd,"component",e)},expression:"menuFormAdd.component"}})],1)],1):t._e(),t._v(" "),n("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[n("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.menuFormAdd.sortOrder,callback:function(e){t.$set(t.menuFormAdd,"sortOrder",e)},expression:"menuFormAdd.sortOrder"}}),t._v(" "),n("span",{staticStyle:{"margin-left":"5px"}},[t._v("值越小越靠前，支持小数")])],1),t._v(" "),n("FormItem",{attrs:{label:"是否启用",prop:"status"}},[n("i-switch",{attrs:{size:"large"},on:{"on-change":t.changeAddSwitch},model:{value:t.addStatus,callback:function(e){t.addStatus=e},expression:"addStatus"}},[n("span",{attrs:{slot:"open"},slot:"open"},[t._v("启用")]),t._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[t._v("禁用")])])],1)],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:t.cancelAdd}},[t._v("取消")]),t._v(" "),n("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitAdd}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var m=n("VU/8")(l,u,!1,function(t){n("vKcV")},null,null);e.default=m.exports},Dd8w:function(t,e,n){"use strict";e.__esModule=!0;var o,s=n("woOf"),a=(o=s)&&o.__esModule?o:{default:o};e.default=a.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}},vKcV:function(t,e){}});
//# sourceMappingURL=12.06fbe65024cbe7f806e0.js.map